<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ election_name }} - Vote Chart</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #4f46e5, #1e3a8a);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
    </style>
</head>
<body class="text-white min-h-screen px-4 py-20">

    <!-- Back to Dashboard -->
    <a href="{{ url_for('admin_dashboard') }}"
       class="fixed top-4 left-4 z-50 text-sm text-white bg-red-500 hover:bg-red-600 px-4 py-2 rounded-xl shadow-lg transition">
        ‚Üê Back to Dashboard
    </a>

    <!-- Choose Election Dropdown -->
    <div class="fixed top-4 right-4 z-50">
        <select id="electionFilter" onchange="redirectToElection()"
            class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-xl shadow-lg cursor-pointer">
            <option value="">üéØ Choose Election</option>
            {% for name in election_names %}
                <option value="{{ name }}" {% if name == election_name %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>
    </div>

    <div class="max-w-3xl mx-auto bg-gray-900 rounded-2xl shadow-lg p-8">
        <h1 class="text-3xl font-bold mb-4 text-center">üìä Vote Chart for <span class="text-yellow-300">{{ election_name }}</span></h1>
        <canvas id="voteChart" width="400" height="400"></canvas>
    </div>

    <script>
        const labels = {{ labels|tojson }};
        const votes = {{ votes|tojson }};

        const ctx = document.getElementById('voteChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: labels,
                datasets: [{
                    label: 'Vote Count',
                    data: votes,
                    backgroundColor: [
                        '#f87171', '#fbbf24', '#34d399', '#60a5fa', '#a78bfa',
                        '#f472b6', '#facc15', '#38bdf8', '#4ade80', '#c084fc'
                    ]
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        labels: {
                            color: "white"
                        }
                    }
                }
            }
        });

        function redirectToElection() {
            const selected = document.getElementById("electionFilter").value;
            if (selected) {
                window.location.href = `/election/${encodeURIComponent(selected)}`;
            }
        }
    </script>
</body>
</html>
